extends ../../layouts/default.pug
include ../../mixins/filter-status.pug
include ../../mixins/search.pug
include ../../mixins/pagination.pug
include ../../mixins/alert.pug

block main

  +alert("success", success, 3000)
  +alert("danger", error, 3000)

  h1 DANH SACH SAN PHAM

  .card.mb-3
    .card-header Bộ lọc danh sách sản phẩm
    .card-body

  .row
    .col-6
      +filter-status(filterStatus)
    .col-6
      +search(keyword)

  .card.mb-3
    .card-header List of products
    .card-body
      form(
        action=`${prefixAdmin}/products/change-multiple?_method=PATCH`
        method="POST"
        id="form-change-multiple"
      ) 
        .d-flex.align-item-start
          .form-group
            select.form-control(name="type")
              option(disabled  selected) Chọn trạng thái
              option(value="active") Còn hàng
              option(value="not active") Hết hàng
              option(value = "delete-all") Xóa tất cả
              option(value = "change-position") Cập nhật vị trí
          .form-group.d-flex.ml-2
            input.form-control(
              type="text"
              value=""
              name="ids"
              class="d-none"
            )
            button.btn.btn-primary.btn-sm.ml-2.text-nowrap(type="submit") Áp dụng
            a(
              href=`${prefixAdmin}/products/create`
              class ="btn btn-outline-success margin-left"
              ) + Thêm mới 
      table.table.table-hover.table-sm(checkbox-multiple)
        thead 
          tr
            th 
              input(type="checkbox" name="check-all")
            th STT
            th Hình ảnh 
            th Tiêu đề 
            th Giá 
            th Vị trí
            th Trạng Thái 
            th Hành Động 
        tbody
          each item, index in products 
            tr
              td 
                input(type="checkbox" name="check-item" value=item._id)
              td #{index + 1}
              td
                img(
                  src=item.thumbnail, 
                  alt=item.title,
                  width="50px",
                  height="auto"
                )
              td #{item.title}
              td #{item.price}$
              td 
                input(
                  type="number"             
                  value=item.position
                  min ="1"
                  name="position"
                  style="width: 80px;"
                )
              td
                if item.status == "active"
                  a.badge.badge-success(
                    href="javascript:;"
                    data-status=item.status 
                    data-id=item._id
                    button-change-status
                  ) Còn hàng
                else
                  a.badge.badge-danger(
                    href="javascript:;"
                    data-status=item.status 
                    data-id=item._id
                    button-change-status
                  ) Hết hàng
              td 
 
                a.btn.btn-warning.btn-sm(
                  href=`${prefixAdmin}/products/edit/${item._id}`
                ) Sửa
                button.btn.btn-danger.btn-sm.ml-1(
                  data-id = item._id
                  button-delete
                ) Xóa
                a.btn.btn-warning.btn-sm(
                  href=`${prefixAdmin}/products/detail/${item._id}`
                ) Chi tiết   
      +pagination(pagination)

  form(
    id="change-status-form"
    method="POST"
    data-path=`${prefixAdmin}/products/change-status` 
    action=""
  )

  form(
    id="delete-item-form"
    method="POST"
    data-path=`${prefixAdmin}/products/delete` 
    action=""
  )
block scripts
  script(src="/admin/js/script.js")
  script(src="/admin/js/product.js")
